== Integration with raid

This step will integrate the keycloak sso with raid portal web ui .

=== Update product-config.xml of portal component

Download installed product-config.xml of portal component and append the below CustomPortalProperties under global tag and update product-config.xml inside cleanup,setup and startup directory of portal component in object storage.

Note: Update `${PORTAL_URL_WITH_PORT}` and `${KEYCLOAK_URL_WITH_PORT}` in the below configuration first.

[source,bash]
----
    <string name="CustomPortalProperties">
      # sso properties
      sso.enabled=true
      sso.callback.url=http://${PORTAL_URL_WITH_PORT}/callback
      sso.auth.type=oidc

      # mapping configurations
      # Map role as sso.mapped.role.<new role name in kc>=<role name in portal>
      # Map group as user_group./<new group name in kc>=<group name in portal>
      sso.mapped.attributes=preferred_username:name,roles:role,group:user_group
      sso.mapped.role.admin=Administrator
      sso.mapped.user_group./admin=Administrator

      # Open ID Connect configurations
      oidc.discovery.uri=http://${KEYCLOAK_URL_WITH_PORT}/realms/master/.well-known/openid-configuration
      oidc.client.id=raid_portal
      oidc.client.secret=XXXX-XXXX-XXXX-XXXX
    </string>
----

=== Upload sso.war

In this step upload updated sso.war inside startup/plugins directory of portal component in object storage.

=== Restart portal

[source,bash]
----
./bin/deploymentmanager.sh restart <portal deployment name>
----